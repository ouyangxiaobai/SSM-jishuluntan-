<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="jbbs_pic" >


  <select id="select" resultType="map" parameterType="cc.javaee.bbs.model.Pic" >
     SELECT 
    t1.id, t1.path, t1.tieziid, t1.bankuaiid, t1.pictype, t1.createuserid, t1.width, t1.height, t1.isdel,t2.name
    FROM jbbs_pic t1 LEFT JOIN jbbs_tiezi t2 ON t1.tieziid=t2.id
    where 1=1
    <if test="id != null" >
	    and t1.id = #{id,jdbcType=INTEGER}
    </if>
    LIMIT 0,10
  </select>
  
  <select id="selectbyindex" resultType="map" parameterType="cc.javaee.bbs.model.Pic" >
    SELECT 
    t1.id, t1.path, t1.tieziid, t1.bankuaiid, t1.pictype, t1.createuserid, t1.width, t1.height, t1.isdel,t2.name
    FROM jbbs_pic t1 LEFT JOIN jbbs_tiezi t2 ON t1.tieziid=t2.id
    WHERE t1.tieziid IS NOT NULL AND t1.width > t1.height AND t1.pictype='0' AND t1.isdel='0' AND t2.isuse='1' ORDER BY id DESC
    LIMIT 0,5
  </select>
  
  
  
  
  <delete id="delete" parameterType="java.lang.Integer" >
    delete from jbbs_pic
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <!-- 根据帖子删除图片 -->
  <delete id="deletebytieziid" parameterType="java.lang.Integer" >
    delete from jbbs_pic
    where tieziid = #{tieziid,jdbcType=INTEGER}
  </delete>
  
  
  <insert id="insert" parameterType="cc.javaee.bbs.model.Pic" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 10 12:45:19 CST 2017.
    -->
    insert into jbbs_pic
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="path != null" >
        path,
      </if>
      <if test="tieziid != null" >
        tieziid,
      </if>
      <if test="bankuaiid != null" >
        bankuaiid,
      </if>
      <if test="pictype != null" >
        pictype,
      </if>
      <if test="createuserid != null" >
        createuserid,
      </if>
      <if test="width != null" >
        width,
      </if>
      <if test="height != null" >
        height,
      </if>
      <if test="isdel != null" >
        isdel,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="path != null" >
        #{path,jdbcType=VARCHAR},
      </if>
      <if test="tieziid != null" >
        #{tieziid,jdbcType=INTEGER},
      </if>
      <if test="bankuaiid != null" >
        #{bankuaiid,jdbcType=INTEGER},
      </if>
      <if test="pictype != null" >
        #{pictype,jdbcType=VARCHAR},
      </if>
      <if test="createuserid != null" >
        #{createuserid,jdbcType=INTEGER},
      </if>
      <if test="width != null" >
        #{width,jdbcType=INTEGER},
      </if>
      <if test="height != null" >
        #{height,jdbcType=INTEGER},
      </if>
      <if test="isdel != null" >
        #{isdel,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="update" parameterType="cc.javaee.bbs.model.Pic" >
    update jbbs_pic
    <set >
      <if test="path != null" >
        path = #{path,jdbcType=VARCHAR},
      </if>
      <if test="tieziid != null" >
        tieziid = #{tieziid,jdbcType=INTEGER},
      </if>
      <if test="bankuaiid != null" >
        bankuaiid = #{bankuaiid,jdbcType=INTEGER},
      </if>
      <if test="pictype != null" >
        pictype = #{pictype,jdbcType=VARCHAR},
      </if>
      <if test="createuserid != null" >
        createuserid = #{createuserid,jdbcType=INTEGER},
      </if>
      <if test="width != null" >
        width = #{width,jdbcType=INTEGER},
      </if>
      <if test="height != null" >
        height = #{height,jdbcType=INTEGER},
      </if>
      <if test="isdel != null" >
        isdel = #{isdel,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
</mapper>